{
  "CommonConfig": "这里是读取公共配置",
  "ConnectionStrings": {
    "DbType": "MySql",
    "SqlConnection": "Server=114.55.177.197;Port=3306;Database=66in;Uid=root;Pwd=66^^66;CharSet=utf8;pooling=true;SslMode=None;Allow User Variables=true;Convert Zero Datetime=True;Allow Zero Datetime=True;"
  },
  "RedisConfig": {
    "Enabled": true,
    "ConnectionString": "114.55.177.197,connectTimeout=1000,connectRetry=1,syncTimeout=10000,DefaultDatabase=8"
  },
  ////健康检查Rabbitmq
  //"“EventBusConnection”": "",
  ////健康检查Redis
  //"RedisConnectionString": "114.55.177.197,connectTimeout=1000,connectRetry=1,syncTimeout=10000,DefaultDatabase=8",
  ////健康检查SqlServer
  //"“ConnectionString”": "Data Source=.;Initial Catalog=HealthDatabase;User ID=sa;Password=123",
  ////健康检查Sql持久化数据库
  //"HealthStorageConnectionString": "Data Source=.;Initial Catalog=HealthDatabase;User ID=sa;Password=123",
  //"HealthChecksUI": {
  //  "HealthChecks": [
  //    {
  //      "Name": "Test Health",
  //      "Uri": "https://localhost:5000/health"
  //    }
  //  ],
  //  "EvaluationTimeinSeconds": 10,
  //  "MinimumSecondsBetweenFailureNotifications": 60
  //},
  //日志设置
  "LoggerSetting": {
    "LogFolder": "APP_DATA",
    "LogSaveDays": 3
  },
  "AllowedHosts": "*",
  //中间件
  "Middleware": {
    //记录请求和响应数据
    "RequestResponseLog": {
      "Enabled": true,
      "IgnoreApis": ""
    },
    //记录IP请求数据
    "IPLog": {
      "Enabled": true
    }
  },
  "IpRateLimiting": {
    //false，则全局将应用限制，并且仅应用具有作为端点的规则*。例如，如果您设置每秒5次调用的限制，则对任何端点的任何HTTP调用都将计入该限制
    //true， 则限制将应用于每个端点，如{HTTP_Verb}{PATH}。例如，如果您为*:/api/values客户端设置每秒5个呼叫的限制，
    "EnableEndpointRateLimiting": false,
    //false，拒绝的API调用不会添加到调用次数计数器上;如 客户端每秒发出3个请求并且您设置了每秒一个调用的限制，则每分钟或每天计数器等其他限制将仅记录第一个调用，即成功的API调用。如果您希望被拒绝的API调用计入其他时间的显示（分钟，小时等），则必须设置StackBlockedRequests为true。
    "StackBlockedRequests": false,
    //Kestrel 服务器背后是一个反向代理，如果你的代理服务器使用不同的页眉然后提取客户端IP X-Real-IP使用此选项来设置
    "RealIpHeader": "X-Real-IP",
    //取白名单的客户端ID。如果此标头中存在客户端ID并且与ClientWhitelist中指定的值匹配，则不应用速率限制。
    //"ClientIdHeader": "X-ClientId",
    "ClientIdHeader": "appid",
    //限制状态码
    "HttpStatusCode": 429,
    //IP白名单:支持Ip v4和v6
    "IpWhitelist": [ "0.0.0.1", "192.168.0.0/24" ],
    //端点白名单:支持各种请求；
    "EndpointWhitelist": [ "get:/ipclient/str", "*:/ipclient/str2" ],
    ////客户端白名单
    //"ClientWhitelist": [ "dev-id-1", "dev-id-2" ],
    //通用规则
    "QuotaExceededResponse": {
      "Content": "{{\"code\":429,\"msg\":\"Visit too frequently, please try again later\",\"data\":null}}",
      "ContentType": "application/json;utf-8",
      "StatusCode": 429
    },
    "GeneralRules": [
      {
        //端点路径
        "Endpoint": "*",
        //时间段，格式：{数字}{单位}；可使用单位：s, m, h, d
        "Period": "1s",
        //限制
        "Limit": 20
      },
      //15分钟只能调用100次
      {
        "Endpoint": "*",
        "Period": "15m",
        "Limit": 100
      },
      //12H只能调用1000
      {
        "Endpoint": "*",
        "Period": "12h",
        "Limit": 1000
      },
      //7天只能调用10000次
      {
        "Endpoint": "*",
        "Period": "7d",
        "Limit": 10000
      }
    ]
  },
  "IpRateLimitPolicies": {
    //ip规则
    "IpRules": [
      {
        //IP
        "Ip": "127.0.0.9",
        //规则内容
        "Rules": [
          //1s请求10次
          {
            "Endpoint": "*",
            "Period": "1s",
            "Limit": 10
          },
          //15分钟请求200次
          {
            "Endpoint": "*",
            "Period": "15m",
            "Limit": 200
          }
        ]
      },
      {
        //ip支持设置多个
        "Ip": "192.168.3.22/25",
        "Rules": [
          //1秒请求5次
          {
            "Endpoint": "*",
            "Period": "1s",
            "Limit": 5
          },
          //15分钟请求150次
          {
            "Endpoint": "*",
            "Period": "15m",
            "Limit": 150
          },
          //12小时请求500次
          {
            "Endpoint": "*",
            "Period": "12h",
            "Limit": 500
          }
        ]
      }
    ]
  },
  "ClientRateLimitPolicies": {
    "ClientRules": [
      {
        "ClientId": "1",
        "Rules": [
          {
            "Endpoint": "*",
            "Period": "10s",
            "Limit": 2
          },
          {
            "Endpoint": "*",
            "Period": "15m",
            "Limit": 200
          }
        ]
      },
      {
        "ClientId": "client-id-2",
        "Rules": [
          {
            "Endpoint": "*",
            "Period": "1s",
            "Limit": 5
          },
          {
            "Endpoint": "*",
            "Period": "15m",
            "Limit": 150
          },
          {
            "Endpoint": "*",
            "Period": "12h",
            "Limit": 500
          }
        ]
      }
    ]
  }
}